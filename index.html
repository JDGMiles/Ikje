<!DOCTYPE html><html><head><title>Ikje</title>

<link rel="stylesheet" type="text/css" href="style.css">
<link rel="shortcut icon" href="favicon.ico">
<meta name="viewport" content="width=689, initial-scale=1">

</head>

<body>
	<center>

		<table style="position:absolute; left:10px; top:10px; background-color:black;">
			<td>
				<a href="#popup1"><img title="Information" src="../jdgmiles.github.io/questionmark.png" style="width:60px; height:60px"></a><br>
				<a href="https://twitter.com/jimdgmiles" target=blank_><img title="James Miles on Twitter" src="../jdgmiles.github.io/twitter.png" style="width:60px; height:60px"></a><br>
				<a href="http://jdgmiles.github.io/" target="_blank"><img title="Projects Page" src="../jdgmiles.github.io/jdgm.png" style="width:60px; height:60px"></a>
			</td>
		</table>

		<div id="popup1" class="overlay">
			<div class="popup">
	      <div style="font-family:Georgia; color:white; text-align:center; font-size:65px">Ikje</div>
	      <a class="close" href="#">&times;</a><br style="line-height:5px">
	      <a style="font-family:Georgia; font-size:40px; color:white; text-align:center;">&ldquo;Ikje&rdquo; is Albanian for &ldquo;escape&rdquo;.</a><br style="line-height:30px">
	    </div>
		</div>

		<canvas id="canvas" style="padding:0px 80px 0px 80px;"></canvas>
  </center>
</body>
</html>

<script type="text/javascript">
var rightdown=0;
var leftdown=0;
var updown=0;
var downdown=0;

document.body.onkeydown = function(e){
	if(rightdown==0 && (e.keyCode == 39 || e.keyCode == 68)){rightdown++;}
	if(leftdown==0 && (e.keyCode == 37 || e.keyCode == 65)){leftdown++;}
	if(updown==0 && (e.keyCode == 38 || e.keyCode == 87)){updown++;}
	if(downdown==0 && (e.keyCode == 40 || e.keyCode == 83)){downdown++;}
}

document.body.onkeyup = function(e){
	if(e.keyCode == 39 || e.keyCode == 68){rightdown=0;}
	if(e.keyCode == 37 || e.keyCode == 65){leftdown=0;}
	if(e.keyCode == 38 || e.keyCode == 87){updown=0;}
	if(e.keyCode == 40 || e.keyCode == 83){downdown=0;}
}

var field={width:650, height:650};
var fieldcolor="#000000";

var canvas=document.getElementById("canvas"), ctx = canvas.getContext("2d");
canvas.width = field.width;
canvas.height = field.height;

var fps=60;

var ringsize=300;
var ringcolour="#000000";
var ringpipingcolour="#00AADD";
var ringpipingwidth=3;

var player={
	x:field.width/2,
	y:field.height/2,
	radius:5,
	colour:"#CC0000",
	outlinecolour:"#FFFFBB",
	outlinewidth:2,
	speed:3
}

var numberofenemies=21;
var enemy=[];
for(i=0; i<numberofenemies; i++){
	enemy[i]={
		x:field.width/2+ringsize*Math.cos(2*Math.PI*i/numberofenemies),
		y:field.width/2+ringsize*Math.sin(2*Math.PI*i/numberofenemies),
		radius:9,
		colour:"#0000CC",
		outlinecolour:"#BBFFFF",
		outlinewidth:2,
		speed:1
	}
}

var doenemiesmove=0;

var time=0;
var restarttime=850;
var restartduration=60;

var goalsize=10;
var goalcolour="#444444";
var goalpipingcolour="#DDDDDD";
var goalpipingwidth=2;

var won=0;
var targettotalenemygoaldistance=200;
var totalenemygoaldistance=targettotalenemygoaldistance+1;

function draw(){

	ctx.fillStyle=fieldcolor;
	ctx.fillRect(0, 0, field.width, field.height);

	ctx.beginPath();
	ctx.arc(field.width/2, field.height/2, ringsize, 0, 2 * Math.PI);
	ctx.fillStyle=ringcolour;
	ctx.lineWidth=ringpipingwidth;
	ctx.strokeStyle=ringpipingcolour;
	ctx.fill();
	ctx.stroke();

	ctx.beginPath();
	ctx.arc(field.width/2, field.height/2, goalsize, 0, 2 * Math.PI);
	ctx.fillStyle=goalcolour;
	ctx.lineWidth=goalpipingwidth;
	ctx.strokeStyle=goalpipingcolour;
	ctx.fill();
	ctx.stroke();

	for(i=0; i<numberofenemies; i++){
		ctx.beginPath();
		ctx.arc(enemy[i].x, enemy[i].y, enemy[i].radius, 0, 2 * Math.PI);
		ctx.fillStyle=enemy[i].colour;
		ctx.lineWidth=enemy[i].outlinewidth;
		ctx.strokeStyle=enemy[i].outlinecolour;
		ctx.fill();
		ctx.stroke();
	}

	ctx.beginPath();
	ctx.arc(player.x, player.y, player.radius, 0, 2 * Math.PI);
	ctx.fillStyle=player.colour;
	ctx.lineWidth=player.outlinewidth;
	ctx.strokeStyle=player.outlinecolour;
	ctx.fill();
	ctx.stroke();

	if(rightdown && (!updown && !downdown)){player.x+=player.speed; doenemiesmove=1;}
	else if(rightdown){player.x+=Math.sqrt(2)*player.speed/2; doenemiesmove=1;}

	if(leftdown && (!updown && !downdown)){player.x-=player.speed; doenemiesmove=1;}
	else if(leftdown){player.x-=Math.sqrt(2)*player.speed/2; doenemiesmove=1;}

	if(updown && (!leftdown && !rightdown)){player.y-=player.speed; doenemiesmove=1;}
	else if(updown){player.y-=Math.sqrt(2)*player.speed/2; doenemiesmove=1;}

	if(downdown && (!leftdown && !rightdown)){player.y+=player.speed; doenemiesmove=1;}
	else if(downdown){player.y+=Math.sqrt(2)*player.speed/2; doenemiesmove=1;}

	if(doenemiesmove){
		totalenemygoaldistance=0;
		for(i=0; i<numberofenemies; i++){
			enemy[i].x-=enemy[i].speed*(enemy[i].x-player.x)/Math.sqrt((enemy[i].x-player.x)*(enemy[i].x-player.x)+(enemy[i].y-player.y)*(enemy[i].y-player.y));
			enemy[i].y-=enemy[i].speed*(enemy[i].y-player.y)/Math.sqrt((enemy[i].x-player.x)*(enemy[i].x-player.x)+(enemy[i].y-player.y)*(enemy[i].y-player.y));
			totalenemygoaldistance+=Math.sqrt((enemy[i].x-field.width/2)*(enemy[i].x-field.width/2)+(enemy[i].y-field.height/2)*(enemy[i].y-field.height/2))
		}
	}

	doenemiesmove=0;

	time++;

	if(totalenemygoaldistance<targettotalenemygoaldistance && !won){restarttime=time; won=1;}

	if(won){
		ctx.beginPath();
		ctx.arc(field.width/2, field.height/2, ((time-restarttime)/restartduration)*ringsize, 0, 2 * Math.PI);
		ctx.fillStyle=ringcolour;
		ctx.lineWidth=ringpipingwidth;
		ctx.strokeStyle=ringpipingcolour;
		ctx.fill();
		ctx.stroke();
	}

	if(won && time==restarttime+restartduration){
		won=0;
		time=0;
		totalenemygoaldistance=targettotalenemygoaldistance+1;
		for(i=0; i<numberofenemies; i++){enemy[i].x=field.width/2+ringsize*Math.cos(2*Math.PI*i/numberofenemies); enemy[i].y=field.height/2+ringsize*Math.sin(2*Math.PI*i/numberofenemies);}
		player.x=field.width/2; player.y=field.height/2;
	}

	setTimeout(draw, 1000/fps);
}

draw();

</script>
